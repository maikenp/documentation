

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Configuration &mdash; Sigma2 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../../_static/sigma2.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> Sigma2/Metacenter documentation
          

          
            
            <img src="../../../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">News</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://opslog.sigma2.no">Latest changes and events</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.sigma2.no/hardware-status">Hardware live status</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting help</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_help/support_line.html">Support line</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_help/how_to_write_good_support_requests.html">Writing good support requests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_help/qa-sessions.html">Open Question &amp; Answer Sessions for All Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_help/lost_forgotten_password.html">Lost or expiring password</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_help/project_leader_support.html">Project leader support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_help/advanced_user_support.html">Advanced User Support (AUS)</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started/applying_account.html">How do I get an HPC account?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started/applying_resources.html">Applying for computing and storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started/training.html">Training material</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started/getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started/editing_files.html">Editing files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started/create_ssh_keys.html">SSH</a></li>
</ul>
<p class="caption"><span class="caption-text">Services</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../nird_archive/user-guide.html">Research data archive</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html">NIRD Toolkit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../services/easydmp-user-documentation.html">EasyDMP User Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_help/course_resources.html">CRaaS - Course Resources as a Service</a></li>
</ul>
<p class="caption"><span class="caption-text">High-performance computing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../hpc_machines/hardware_overview.html">Overview over our machines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../hpc_machines/betzy.html">Betzy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../hpc_machines/fram.html">Fram</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../hpc_machines/saga.html">Saga</a></li>
<li class="toctree-l1"><a class="reference external" href="https://hpc-uit.readthedocs.io">Stallo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../hpc_machines/migration2metacenter.html">Migration to a Metacenter HPC machine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../jobs/overview.html">Job types and job scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../code_development/overview.html">Code development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../computing/tuning-applications.html">Tuning applications</a></li>
</ul>
<p class="caption"><span class="caption-text">Software</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../software/modulescheme.html">Software Module Scheme</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../software/installed_software.html">Installed Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../software/userinstallsw.html">Installing software as user</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../software/containers.html">Running Singularity and Docker containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../software/appguides.html">Application guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../software/licenses.html">Licenses and access policies</a></li>
</ul>
<p class="caption"><span class="caption-text">Files and Storage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../files_storage/nird.html">NIRD - National Infrastructure for Research Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../files_storage/clusters.html">Storage areas on HPC clusters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../files_storage/backup.html">Backup on Betzy, Fram, Saga, and NIRD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../files_storage/sharing_files.html">Data handling and storage policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../files_storage/file_transfer.html">File transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../files_storage/performance.html">Storage performance tuning</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Sigma2/Metacenter documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Configuration</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com/UNINETTSigma2/documentation/blob/master/nird_toolkit/about-packages/jupyter/about.md" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="configuration">
<h1>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h1>
<div class="section" id="enabling-jupyterlab">
<span id="configuration-jupyter-package"></span><h2>Enabling JupyterLab<a class="headerlink" href="#enabling-jupyterlab" title="Permalink to this headline">¶</a></h2>
<p>JupyterLab is the next-generation of Jupyter notebooks and provides a more
flexible and powerful user-interface. To enable JupyterLab, go to <code class="docutils literal notranslate"><span class="pre">Advanced</span> <span class="pre">configuration</span></code> while installing, and check the <code class="docutils literal notranslate"><span class="pre">jupyterLab</span></code> checkbox.</p>
</div>
</div>
<div class="section" id="usage">
<h1>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h1>
<p>The Jupyter package provides a pre-configured development environment based
around Jupyter notebooks. Using this notebook, you are able to develop using
Python, Scala and R.</p>
<p>Below are some tutorials describing how to use Jupyter notebooks for various different things:</p>
<div class="section" id="installing-custom-packages">
<h2>Installing custom packages<a class="headerlink" href="#installing-custom-packages" title="Permalink to this headline">¶</a></h2>
<p>In some cases the pre-installed libraries are not enough. Jupyter notebooks
allow you to run arbitrary shell commands directly from inside the notebook.
In order to run a command, in this case <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">plotly</span></code>, prefix the
command with an exclamation mark, like so: <code class="docutils literal notranslate"><span class="pre">!pip</span> <span class="pre">install</span> <span class="pre">plotly</span></code>.
<img alt="Installing plotly" src="../../../_images/jupyter_pip_install.png" /></p>
<p>You should then be able to use the library as you normally would.
<img alt="Using plotly" src="../../../_images/jupyter_plotly.png" /></p>
<p>Note: in most cases the method outlined above will work, but if it doesn’t see the following link for more details:
https://jakevdp.github.io/blog/2017/12/05/installing-python-packages-from-jupyter/</p>
</div>
<div class="section" id="connecting-a-jupyter-notebook-to-apache-spark">
<h2>Connecting a Jupyter notebook to Apache Spark<a class="headerlink" href="#connecting-a-jupyter-notebook-to-apache-spark" title="Permalink to this headline">¶</a></h2>
<div class="section" id="prerequisites">
<span id="apache-spark-with-jupyter"></span><h3>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p>Knowledge of how to install a package <a class="reference internal" href="../../package-install.html#configuration-general-package"><span class="std std-ref"> Link to package install tutorial</span></a>
is useful, but not needed.</p></li>
</ol>
</div>
<div class="section" id="creating-the-spark-cluster">
<h3>Creating the Spark cluster<a class="headerlink" href="#creating-the-spark-cluster" title="Permalink to this headline">¶</a></h3>
<p>First, we need to create an Apache Spark cluster. We will do this by installing
the <code class="docutils literal notranslate"><span class="pre">spark</span></code> package, but you can also connect to any publicly accessible
Spark cluster.</p>
<p>Fill in the <code class="docutils literal notranslate"><span class="pre">Application</span> <span class="pre">name</span></code> and <code class="docutils literal notranslate"><span class="pre">URL</span></code> as desired. If you need more than one
worker, or more resources are required for the workers and master, go to the
<code class="docutils literal notranslate"><span class="pre">Advanced</span> <span class="pre">configuration</span></code> section, and change these to your desired values.
[Image of spark install form with values filled in]</p>
<p>When the application is running, copy the Spark master URL in the
<code class="docutils literal notranslate"><span class="pre">Application</span> <span class="pre">notes</span></code> section. This will later be used to specify which cluster
the notebook will attempt to connect to.
[Image of the Spark application with emphasis on the master URL]</p>
</div>
<div class="section" id="creating-the-notebook">
<h3>Creating the notebook<a class="headerlink" href="#creating-the-notebook" title="Permalink to this headline">¶</a></h3>
<p>It is now time to install Jupyter. Navigate back to the package library, and
go to the Jupyter installation page. Fill in the <code class="docutils literal notranslate"><span class="pre">Application</span> <span class="pre">name</span></code> and <code class="docutils literal notranslate"><span class="pre">URL</span></code>
once again.</p>
</div>
<div class="section" id="connecting-to-apache-spark">
<h3>Connecting to Apache Spark<a class="headerlink" href="#connecting-to-apache-spark" title="Permalink to this headline">¶</a></h3>
<p>Now go to the <code class="docutils literal notranslate"><span class="pre">Advanced</span> <span class="pre">configuration</span></code> section and paste in
the Spark master URL you obtained in one of the previous steps.
The package is now ready to be installed, so go ahead and press <code class="docutils literal notranslate"><span class="pre">Install</span></code>.</p>
<p><img alt="Jupyter application overview" src="../../../_images/jupyter_application_overview.png" /></p>
<p>Click on the link in the <code class="docutils literal notranslate"><span class="pre">URL</span></code> column in order to access the Jupyter notebook.
In order to test the connection to Spark, you first need to create a
notebook. Then, you can use the following code sample in order to use Spark:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyspark</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="k">def</span> <span class="nf">inside</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
	<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(),</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
	<span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">y</span> <span class="o">&lt;</span> <span class="mi">1</span>

<span class="n">sc</span> <span class="o">=</span> <span class="n">pyspark</span><span class="o">.</span><span class="n">SparkContext</span><span class="p">(</span><span class="n">appName</span><span class="o">=</span><span class="s2">&quot;Pi&quot;</span><span class="p">)</span>
<span class="n">num_samples</span> <span class="o">=</span> <span class="mi">1000000</span>

<span class="n">count</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">parallelize</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">))</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">inside</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="n">pi</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">count</span> <span class="o">/</span> <span class="n">num_samples</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>

<span class="n">sc</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>
</div>
<p>While running the application, you can visit the Spark cluster dashboard by
first navigating to the application overview for the previously created Spark
application, and the visiting the URL in the application overview.
[Image of the Spark dashboard overview]
Here you will be able to see all applications registered with your Spark
Cluster, and you are able to access the Spark logs. (This should probably be a tutorial on its own)</p>
</div>
</div>
<div class="section" id="how-to-add-new-packages">
<h2>How to add new packages<a class="headerlink" href="#how-to-add-new-packages" title="Permalink to this headline">¶</a></h2>
<p>In case you are missing some packages from the default application image, you can add those packages yourself by creating a custom docker image.
See  <a class="reference internal" href="../../custom-docker-image.html#custom-docker-image"><span class="std std-ref">this tutorial</span></a> for generic instructions on how to add packages.</p>
<p>After having read the tutorial above, you can use the dockerfile below as a starting point when creating the dockerfile that adds new packages.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># See the value of dockerImage in</span>
<span class="c1">#</span>
<span class="c1">#   https://github.com/Uninett/helm-charts/blob/master/repos/stable/jupyter/values.yaml</span>
<span class="c1">#</span>
<span class="c1"># to determine the latest base image</span>

<span class="n">FROM</span> <span class="n">quay</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">uninett</span><span class="o">/</span><span class="n">jupyter</span><span class="o">-</span><span class="n">spark</span><span class="p">:</span><span class="o">&lt;</span><span class="n">insert</span> <span class="n">latest</span> <span class="n">tag</span> <span class="n">here</span><span class="o">&gt;</span>

<span class="c1"># Install system packages</span>
<span class="n">USER</span> <span class="n">root</span>
<span class="n">RUN</span> <span class="n">apt</span> <span class="n">update</span> <span class="o">&amp;&amp;</span> <span class="n">apt</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="n">vim</span>

<span class="c1"># Install other packages</span>
<span class="n">USER</span> <span class="n">notebook</span>
<span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">scikit</span><span class="o">-</span><span class="n">learn</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Sigma2/Metacenter.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>